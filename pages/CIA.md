# CIA: Sherlock's Gambit's Client

This guide is here to help you get started with the client! It will be updated regularly so come back here to get the latest updates!
|Version | Date | Changelog
|--|--|--|
| 1.0 | 21/03 | Initial version|

## Downloading the client
- The client is available on the Moodle page: [here](https://moodle.cri.epita.fr/mod/folder/view.php?id=13926)
- You can download the ZIP file, extract it. Since the client is available on multiple systems, you must use the appropriate tool to extract the client.
	- The classic `unzip` command on Linux distributions should do the job
- The client will be updated regularly, please check this page once in a while. 
- To run the client on the `PIE`, **please run the following commands**, once extracted:
```
 42sh$ nix profile install nixpkgs#steam-run --impure
 42sh$ ./linux-cia-1.0 
 # don't forget to replace 1.0 by the version
```

## Entering the game
### Generating a DLL and finding it
- The client uses the DLL file generated by the C# when using Rider (or any alternative compiler). So, you must first generate one by running your TP at least once.

- This file is usually located in the `bin` or `obj` folder of your project:
```
42sh$ ls bin/Debug/net5.0
SherlocksGambit.deps.json  SherlocksGambit.dll SherlocksGambit.runtimeconfig.json  randNum.txt
```
- You must find the `SherlocksGambit.dll` file in this folder
- We highly recommend copying the file over to the `CIA-data` folder of your TP/client.

Once found and copied, you can load it using the navigator in the `Import your file` section by clicking on the upload icon:
- Loading the DLL![How to open the navigation menu](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/DLL-loading-button.png)
- Selecting the file![Selecting a DLL](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/dll-selection.png)
- If the file is valid
![Valid](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/both-done.png)

**Beware**: if you change anything in your TP, you must reload your DLL and come back to this screen to have your changes on the client.

**Warning**: if you modify any of the classes in the given code (name, prototype), the client will not work correctly.

### Logging in the client
To access the client, you must connect your EPITA's Microsoft account to our API. To do so, when you click on the login button, you will have to follow multiple steps:

 1. Click once: the client will generate a code and **paste** it into your clipboard **automatically**.
![Login with token](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/API-Login.png)
 2. Click a second time, it will open a navigation tab on your favorite browser. It will prompt you to enter the token from step 1, paste it and log in your EPITA's Microsoft account.  
![Token screen](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/login-token.png)
 3. If you have followed thoroughly the steps, you can go back to the client and a checked box should appear. 
![Login done](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/login-done.png)

Once you have completed both steps, you can enter the main menu by clicking on the new button.

An API is needed to retrieve your login and your group. However, we will **never** use in any case your personal data.


## Game modes
Three sections are available:
1. Sandbox (Offline mode for your tests)
2. LeaderBoard (**TBA**)
3. VS (**TBA**)

![Homescreen](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/homescreen.png)

### Sandbox Mode
There are three game modes available in this module
#### 1. Board loader
**Requires the FEN encryption from Threshold 1**
- This mode provides a visualizer for the FEN codes. You can customize the `Board Fen's code` string to print a new one.
![FEN encryption](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/FEN%20editor.png)

- If the code is not a valid one, the client will generate an exception and put the log in a file (at the path specified on the UI)

#### 2. Game viewer

**Requires the FEN encryption and the move encryption and decryption parts**
With move encryption and decryption, you should be able to generate your first .cia file. It contains a set of moves encrypted and each of them is separated by a line.

You can use those files to visualize a set of moves done by your AI during a test.

To do so, you must use a similar procedure to the `DLL loading` but with a `.cia` file.

![.cia file loading](https://raw.githubusercontent.com/vertven/checkers-doc/main/img/cialoading.png)

Then, you can enter the game and move between the different moves by using the arrow keys of your keyboard or the keys from your WASD/WQSD pad (depending on your keyboard layout)

An example of a valid `.cia` file is:

> (9-14)  
> 22-18  
> (5-9)  
> 24-20  

#### 3. AI vs AI
**The entire TP is required to use this game mode**

You can use this mode to load your fresh AI and make two of those battle against each other. The controls from the `Game viewer` are still valid.

## Known issues
If there is any issue, we will put it here!

Last updated: 21/03/22 17h

